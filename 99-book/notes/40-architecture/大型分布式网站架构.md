《大型分布式网站架构设计与实践》陈康贤

* soa 服务框架
* 缓存、存储、消息、搜索引擎
* 安全 加密算法、摘要、签名
* 稳定 日志分析、集群监控、流量控制、性能优化、故障排查
* 数据分析 日志收集、离线分析、流式分析、数据同步、数据报表

## 第1章 面向服务的体系结构（SOA）
### 1.1 基于TCP协议的RPC
### 1.2 基于HTTP协议的RPC
### 1.3 服务的路由和负载均衡
SOA架构中，通服务名称找到要调用的服务的地址列表，称为服务的路由。
#### 1.3.2 负载均衡算法
1. 轮询算法
2. 随机
3. 源地址哈希
4. 加权轮询
5. 加权随机

#### 1.3.3 动态规则配置
#### 1.3.7 路由和负载均衡算法的实现
### 1.4 HTTP服务网关

## 第2章 分布式系统基础设施
### 2.1 分布式缓存
#### 2.1.3 分布式session
### 2.2 持久化存储
#### 2.2.1 MySQL扩展
业务拆分、复制策略、分表与分库
#### 2.2.2 HBase
#### 2.2.3 Redis
### 2.3 消息系统
### 2.4 垂直化搜索引擎
#### 2.4.1 Lucene简介
#### 2.4.3 Solr
### 2.5 其他基础设施
实时计算、离线计算、分布式文件系统、日志收集系统、监控系统、数据仓库、
CDN系统、负载均衡系统、消息推送系统、自动化运维

## 第3章 互联网安全架构
### 3.1 常见的Web攻击手段
* XSS攻击
* CRSF攻击
* SQL注入攻击
* 文件上传漏洞
* DDoS攻击
* 其他攻击手段

### 3.2 常用的安全算法
#### 3.2.1 数字摘要
MD5、SHA、十六进制编码、Base64编码、彩虹表破解Hash算法
#### 3.2.2 对称加密算法
DES、AES
#### 3.2.3 非对称加密算法
RSA
#### 3.2.4 数字签名
非对称加密算法与数字摘要技术的综合运用，指的是将通信内容的**摘要信息**使用**发送者的私钥**进行加密，
然后将密文与原文一起传输给信息的接收者，接收者通过**发送者的公钥进行解密**被加密的摘要信息，
然后使用与发送者相同的摘要算法，对接收到的内容采用相同的方式产生摘要串，与解密的摘要串对比。
#### 3.2.5 数字证书

### 3.3 摘要认证
* 为什么需要认证
* 摘要认证的原理
* 摘要认证的实现

### 3.4 签名认证
* 签名认证的原理
* 签名认证的实现

### 3.5 HTTPS协议
* HTTPS协议的原理
* SSL/TLS
* 部署HTTPS Web

### 3.6 OAuth协议
* OAuth
* OAuth授权过程

## 第4章 系统稳定性
### 4.1 在线日志分析
### 4.2 集群监控
#### 4.2.1 监控指标
* load `top`, `uptime`
* cpu利用率 `top | grep Cpu`
* 磁盘剩余空间 `df -h` 查看剩余空间
* 网络traffic `sar -h DEV 1 1` 查看网络状态
* 磁盘I/O `iostat -d -k`
* 内存使用 `free -m`
* qps
* rt response time 请求响应时间
* select/ps 每秒处理select语句的数量
* update/ps, delete/ps
* GC Young(Eden, Suvivor From To, Tenure, Permante)

#### 4.2.2 心跳检测
1. ping
2. 应用层检查 curl
3. 业务检测

#### 4.2.3 容量评估及应用水位

### 4.3 流量监控
#### 4.3.1 流量控制实施
* 超出流量直接丢弃
* 基于Java的信号量机制Semaphore
* 通过单机内存队列进行有限的等待
* 分布式消息将请求异步化
    削峰填谷

#### 4.3.2 服务稳定性
* 依赖管理
* 优雅降级
* 服务分级
* 开关
* 应急预案
  * 明确服级别、梳理核心应用调用链路
  * 低级别的调用实现准备好开关和接口
  * 优先级-丢车保帅

#### 4.3.3 高并发系统设计
保证系统的**可用性**和可扩展性，又要兼容数据的**一致性**，处理多线程**同步**问题
* 操作原子性 Java原子操作、数据原子操作
* 多线程同步 协同步调，按照预定的次序来执行 synchronized、volatile、lock
* 数据一致性 CAP、BASE 强一致性、弱一致性、最终一致性，分库分表
* 系统可扩展性
* 并发减库存 验证码防刷、数据一致性、多条件更新库存、库存单条记录拆分多条记录

### 4.4 性能优化
#### 4.4.1 如何寻找性能瓶颈
* 前端优化工具-YSlow
* 页面响应时间 firebug
* 方法响应时间 btrace
* GC日志分析
* 数据库查询 `log_slow_qqueries long_query_time`
* 系统资源使用

#### 4.4.2 性能测试工具
* ApacheBench
* ApacheJMeter
* HP LoadRunner
* 反向代理引流
* TCPCopy

#### 4.4.3 性能优化措施
* 前端性能优化
* Java程序优化
  * 单例
  * Future模式
  * 线程池
  * 选择就绪
  * 减少上下文切换
  * 降低锁竞争
* 压缩
* 结果缓存
* 数据库查询性能优化
  * 合理使用索引 独立的列（表达式、函数不走索引），模糊查询
  * 反范式设计
  * 使用查询缓存
  * 使用搜索引擎
  * 使用key-value数据库
* GC优化
* 硬件提升性能

### 4.5 Java引用故障的排查
#### 4.5.1 常用的工具
* jps, jstat, jinfo, 
* jstack, jmap(-heap, -dump, -permstat)
* BTrace, 
* jconsole, eclipse mat, visualvm

#### 4.5.2 典型案例分析
##### 内存溢出
##### 线程死锁或信号量没释放
##### 类加载冲突
NoClassDefFoundError, NoSuchMethodError

## 第5章 数据分析
### 5.1 日志收集
### 5.2 离线数据分析
### 5.3 流式数据分析
### 5.4 数据同步
### 5.5 数据报表
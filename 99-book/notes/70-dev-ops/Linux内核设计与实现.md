《Linux内核设计与实现》[美]Robert Love著 陈莉君 康华 译

* 内核、进程管理、进程调度、系统调用、内核数据结构
* 中断和中断处理、下半部和推后执行的工作
* 内核同步介绍、内核同步方法、定时器和时间管理
* 内存管理、虚拟文件系统、块I/O层、进程地址空间
* 页高速缓存和页回写、设备与模块
* 调试、可移植性、补丁、开发和社区

## 第1章 Linux内核简介
Torvalds李纳斯·托沃兹, linux之父，全名Linus Benedic Torvalds ，是一位出生于1969.12.28的芬兰人。
### 1.3 操作系统和内核简介 
操作系统就是指在整个系统中负责完成最基本功能和系统管理的部分，内核、设备驱动程序、启动引导程序、命令行Shell
或其他种类的用户界面、基本的文件管理工具和系统工具。  
应用程序通过系统调用与内核通信。  
中断机制。当硬件设备想和系统通信的时候，它首先要发出一个异步的中断信号去打断处理器的执行，继而打断内核的执行。
中断通常对应着一个中断号，内核通过这个中断号去查找相应的中断服务程序，并调用这个程序相应和处理中断。

## 第2章 从内核出发 
### 2.1 获取内核源码
http://www.kernel.org
```
git clone git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux-2.6.git
```
### 2.2 内核源码树

| 目录          | 描述                             |
|:--------------|:-------------------------------|
| arch          | 特定体系结构的源码               |
| block         | 块设备I/O层                      |
| crypto        | 加密API                          |
| Documentation | 内核源码文档                     |
| drivers       | 设备驱动程序                     |
| firmware      | 使用某些驱动程序而需要的设备固件 |
| fs            | VFS和各种文件系统                |
| include       | 内核头文件                       |
| init          | 内核引导和初始化                 |
| ipc           | 进程间通信代码                   |
| kernel        | 像调度程序这样的核心子系统       |
| lib           | 通用内核函数                     |
| mm            | 内存管理子系统和VM               |
| net           | 网络子系统                       |
| samples       | 示例 示范代码                    |
| scripts       | 编译内核所用的脚本               |
| security      | Linux安全模块                    |
| sound         | 语音子系统                       |
| usr           | 早期用户空间代码                 |
| tools         | 工具                             |
| virt          | 虚拟化基础结构                   |

### 2.4 内核开发的特点
#### 2.4.1 无libc库抑或无标准头文件 
#### 2.4.2 GNUC 
#### 2.4.3 没有内存保护机制 
#### 2.4.4 不要轻易在内核中使用浮点数 
#### 2.4.5 容积小而固定的栈 
#### 2.4.6 同步和并发 
* 抢占式多任务操作系统
* 支持对称多处理器
* 中断是异步到来的
* 内核可以抢占  
解决办法自旋锁和信号量

#### 2.4.7 可移植性的重要性 

## 第3章 进程管理 
### 3.1 进程
进程就是处于执行期的程序一起相关的资源的总称。程序代码本身不是进程。  
执行线程，简称线程，是在进程中活动的对象。每个线程都拥有一个独立的程序计数器、进程栈和一组进程寄存器。  
进程另一个名字是任务。Linux内核通常把进程也叫做任务。
### 3.2 进程描述符及任务结构 
### 3.3 进程创建 
### 3.4 线程在Linux中的实现 
### 3.5 进程终结 

## 第4章 进程调度 
调度程序负责决定将哪个进程投入运行，何时运行以及运行多长时间。进程调度程序可看做在可运行状态进程之间分配
有限的处理器时间自由的内核子系统。  
在一组处于可运行状态的进程中选择一个来执行，是调度程序所需完成的基本工作。

## 第5章 系统调用 
## 第6章 内核数据结构 
### 6.1 链表 
### 6.2 队列 
### 6.3 映射 
### 6.4 二叉树 
### 6.5 数据结构以及选择 
### 6.6 算法复杂度 

## 第7章 中断和中断处理 
## 第8章 下半部和推后执行的工作 
## 第9章 内核同步介绍 
### 9.1 临界区和竞争条件 
### 9.2 加锁 
### 9.3 死锁 
### 9.4 争用和扩展性 

## 第10章 内核同步方法 
### 10.1 原子操作 
### 10.2 自旋锁 
### 10.3 读一写自旋锁 
### 10.4 信号量 
### 10.5 读一写信号量 
### 10.6 互斥体 
### 10.7 完成变量 
### 10.8 BLK：大内核锁 
### 10.9 顺序锁 
### 10.10 禁止抢占 
### 10.11 顺序和屏障 

## 第11章 定时器和时间管理 
## 第12章 内存管理 
### 12.1 页 
内核把物理页作为内存管理的基本单位。内存管理单元（MMU，管理内存并把虚拟地址转换为物理地址的硬件）

```c
// <linux/mm_types.h>
struct page {
    unsigned long flags;
    atomic_t _count;
    atomic_t _mapcount;
    unsigned long private;
    struct address_space *mapping;
    pgoff_t index;
    struct list_head lru;
    void *virtual;
}
```

### 12.2 区 
由于硬件的限制，内核并不能对所有的页一视同仁。内核把页划分为不同的区（zone）。

* ZONE_DMA
* ZONE_DMA32
* ZONE_NORMAL
* ZONE_HIGMEM  

Linux把系统的页划分为区，形成不同的内存池，这样就可以根据用途进行分配了。

### 12.3 获得页 
```c
struct page * alloc_pages(gfp_t gfp_mask, unsigned int order)
```

### 12.4 kmalloc()
```c
/**
 * @param size
 * @param flags
 * @return 返回一个指向内存块的指针，其内存块至少要有size大小
 *        所分配的内存在物理上是连续的
 */
void * kmalloc(size_t size, gfp_t flags)

void kfree(const void *ptr)
```

### 12.5 vmalloc()
分配的内存虚拟地址是连续的，物理地址无须连续。

### 12.6 slab层 
### 12.7 在栈上的静态分配 
### 12.8 高端内存的映射 
### 12.9 每个CPU的分配 
### 12.10 新的每个CPU接口 
### 12.11 使用每个CPU数据的原因 
### 12.12 分配函数的选择 

## 第13章 虚拟文件系统 
## 第14章 块I/O层 
## 第15章 进程地址空间 
## 第16章 页高速缓存和页回写 
## 第17章 设备与模块 
## 第18章 调试 
## 第19章 可移植性 
## 第20章 补丁、开发和社区 